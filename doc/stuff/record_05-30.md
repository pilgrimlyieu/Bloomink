# 5 月 30 日记录

- 记录人：[@PilgrimLyieu](https://github.com/pilgrimlyieu)
- 记录时间：2024 年 5 月 30 日

距离上次记录又过去了近三周。上次记录是在中期文档 DDL 时记录的，而今天则是在最终项目 DDL 来写下从中期文档以来项目的进程。

昨天，也就是 29 号晚，已经把最终项目成品发邮件提交了，最重要的代码部分也就此告一段落了。也算是长舒一口气了。

![](img/05-30_email.png)

还是感慨万分，我和组员们是完全没有前端开发经验的，从几次开会才确定具体方向，但一直没有开始真正写代码，到后面推倒重来，重新开辟一条新的路径，才让项目焕发了新的生机。

即便如此，在中期文档时我也是内心含着忧虑，心中其实已经将 AI 组件放弃了，想着要是能完成其它组件，就已经基本算「大功告成」了，而 AI 部分，就可以写在所谓的「未来展望」当中了。

然后即使开始写代码，毕竟是懵懂无知的新手，在开发第一个组件，也就是 CultureLibrary 组件时也曾对着 VSCode 一个下午毫无进展，内心濒临崩溃，一度关掉全部窗口，打算就此放弃了。

好在，还是最终坚持下来了，组件的进度突飞猛进，还有组员的学习进度也超出了我的预期，帮助我完成了部分 AI 组件的代码。可以说是超预期实现了我起初的构想。

## 垃圾邮件

![](img/05-30_spam.png)

已经发了中期文档，但是却位列尚未提交的名单，原来是中期文档邮件被当成垃圾邮件了。

## 历程

下面截取一些 QQ 群里的开发历程，基本是我本人完成一部分工作后比较兴奋的写照。

### `CultureLibrary` 组件

![](img/05-30_cl-1.png)

11 日终于基本实现了文化库组件，可见相较于现在，最初的版本还是比较简陋的（虽然现在其实也不怎么样）。

![](img/05-30_cl-2.png)

随后经过差不多三个小时，也终于完成了预想中点击出现详细信息的效果。

![](img/05-30_cl-3.png)

零点后也在写，总算是基本完成了构想中的全部功能。并提交了我的第一个代码 PR：[完成 `CultureLibrary` 组件](https://github.com/pilgrimlyieu/Bloomink/pull/14)。

### Copilot 的经验之谈

在完成 `CultureLibrary` 组件后，我也算是有点「开窍」了。在与 Copilot 的拉扯、相爱相杀中，我也逐渐掌握了一点技巧。

![](img/05-30_copilot.png)

其实说「差不多没有自己写的」也不甚准确，至少后面不太准确了。后面熟悉一点写法后，自己写的比例就大大提高了，只有一些可能只出现一次两次的用法还是会去请教 Copilot。

而这时候实际上已经到 16 号了。

### `Attachment` 组件

![](img/05-30_a-1.png)

然后到了 18 号，完成了最简单的组件「资料库」，即便如此调图片也耗费了蛮多精力，~~最后也是随便糊弄一下了~~。

![](img/05-30_a-2.png)

在逐渐适应了，有点「如鱼得水」后，我也给组员委派了比较简单的工作，只是简单的重复工作，完全不需要有相应的代码基础。

![](img/05-30_a-3.png)

![](img/05-30_a-4.png)

![](img/05-30_a-5.png)

即便如此我也详细地说明了要改什么、怎么改。除此之外还有 VSCode 的 Git、GitHub Pull Request 等等的指导。

也让每个组员都能够体验一下合并一个 PR：[为 `Attachment` 组件添加俩个文化库（经典国学网和中国国学网），并修复一处网址错误](https://github.com/pilgrimlyieu/Bloomink/pull/16)

![](img/05-30_ai-1.png)

与此同时，另一个组员也揽了 AI 组件的任务。

### `TextOCR` 组件

OCR 组件基本是很早就定下来了，毕竟是我个人的私货，以及 OCRC 至少目前在我这里还是有很重的地位的。最终在 18 日完成。

![](img/05-30_t-1.png)

可以发现用来测试的图片，与 [OCRC 的介绍文档](https://pilgrimlyieu.github.io/2023/09/ocrc/#百度-OCR)一模一样。

### 隐私意外

![](img/05-30_private.png)

21 日时一位组员意外将隐私信息提交到了 GitHub 上，被我发现了。

其实远没有这么简单就能解决，GitHub 记录了每个 commit，即使 force push 了 commit 还是在的，只不过是 dangling 的。

然后 23 年 GitHub 增加了个 activity page，那就更致命了，还能直接定位 force push，直接找到隐私信息。

好在这种局面我也不是没遇见过，解决方法就是找 GitHub Support，去清理仓库 cahce。不过上次开 ticket 也为时已久了，刚去弄时还忘了咋搞，以为可以了实际上还没创建 ticket。

![](img/05-30_ghs-1.png)

![](img/05-30_ghs-2.png)

![](img/05-30_ghs-3.png)

这样才算是清理掉了隐私信息。

另外今天（5 月 30 日）还更新了中期文档，增加了用以区分公开和私密版本中期文档的代码，同时提交了下公开版本的中期文档。

```tex
\def\PUBLICVERSION{}

\ifdefined\PUBLICVERSION
    \input{public.tex}
\else
    \input{private.tex}
\fi
```

### `FormulaOCR` 组件

![](img/05-30_f.png)

21 日晚，公式 OCR 组件也顺利完工了。当然没有像 18 日晚说的那样，当天「依葫芦画瓢」就能搞定。

### AI 指导

22 日，完成挺多组件后，我没有立刻投入到新组件的开发，而是决定优化一下现有的组件。与此同时，也给开发 AI 组件的组员提供了一些指导。

![](img/05-30_tch-1.png)

上面的内容是我乱讲的，纯粹是我个人的感觉，只不过也懒得去查证真实的答案。

![](img/05-30_tch-2.png)

比如讲了一下如何看调用结果，以及端口转发的事情。讲述了我踩的一些坑以及解决方案。当然也都是个人经验，实际上可能有很多问题。

![](img/05-30_tch-3.png)

比如 Bash 的语法问题。

![](img/05-30_tch-4.png)

还有代码问题……（太多了我就只截取开头的部分了，后面还有关于 message 等等方面的问题）

![](img/05-30_tch-5.png)

我的重构优化进行中……以及产品名称「春纷」此刻已经诞生了。

### 重构优化

18 日的时候就已经计划进行代码优化了。

![](img/05-30_ref-1.png)

22、23 两天，我重构了部分现有的组件，修改了数据结构，以实现优化：[优化现有组件，以提高代码可读性、可拓展性等及 Web 应用性能](https://github.com/pilgrimlyieu/Bloomink/pull/19)。

![](img/05-30_ref-2.png)

例如将 `Attachment` 组件的网站弄到一个数组里，再使用 `v-for`，这样就可以很方便地添加新的网站了。

然后还修复了其它组件的各种问题，同时为 OCR 等组件添加了切换组件时能够缓存信息的功能。

然后原本的诗词数据是离散的，而且序号也不连续（因为我筛选了数据），于是我也重新分配的序号，并且整合到了单个文件，免去了多次请求以及需要在代码对数据进行重新、多次整理的烦扰。而且通过将这些数据保存在 indexDB 中，只需要在开始时请求一次，之后就可以直接从 indexDB 中获取数据，大大优化了性能。

### AI 组件开发

手机 QQ 可以快速地截取聊天记录，同时隐去头像、名称（但马赛克程度对头像来说不够，因此我还是手动裁掉了，对后面大部分对话没有影响，但某些三个人均参与的对话，可能会造成理解上的障碍）。

同时，@ 人也没有打码，这也是需要我手动进行的，不过比起之前每块都要我手动打码，还是方便多了。

![](img/05-30_ai-2.png)

24 日我也投入到了 `AIImage` 组件的开发，与组员 `AIChat` 和 `AITips` 的开发并行。

![](img/05-30_ai-3.png)

也是一样，只截取了开头的部分，后面还有很多聊天记录。

24 晚，也包括 25 号凌晨，组员完成了开发，进行了 commit，然后我也进行了代码审核：[完成 `AIChat` 和 `AITips` 组件](https://github.com/pilgrimlyieu/Bloomink/pull/18)。并与 25 号下午合并到了主分支（不过解决冲突时引入了新错误）。

### AI 组件优化

虽然组员完成了 `AIChat` 和 `AITips` 两个组件的开发，但其实还有许多问题亟待解决，例如缓存内容、聊天框样式等等，而这些也就由我承包了。

![](img/05-30_air-1.png)

与此同时，在我进行 AI 组件的优化时，也让组员去准备答辩的材料、素材、PPT 等工作了。

![](img/05-30_air-2.png)

各种各样的问题：如跨域图片保存、AI 上下文等等等等……

![](img/05-30_air-3.png)

跟上面一样。

![](img/05-30_air-4.png)

还谈了点 Markdown, $\LaTeX$ 的事情。

![](img/05-30_air-5.png)

还有因为对流式理解错误而浪费了一点时间。

### 图标

虽然名字已经决定了，但是图标也是一大难点，我起初也没啥头绪，打算随便应付一下。

![](img/05-30_icon-1.png)

随便夹带了点私货。

![](img/05-30_icon-2.png)

只可惜效果不好。

![](img/05-30_icon-3.png)

~~甲方的要求~~——有「春天气息」的图标。

![](img/05-30_icon-4.png)

最后还是在图标库选择了最终的图标。

![](img/05-30_icon-5.png)

然后就是标题、图标以及简介的制作。

![](img/05-30_icon-6.png)

![](img/05-30_icon-7.png)

还得是 ChatGPT 4o，说到我心坎了。

### 打包

弄图标过程中还穿插尝试了下打包发布。

![](img/05-30_pack-1.png)

使用的是 Vue CLI。

![](img/05-30_pack-2.png)

然后发现 Vue CLI 已经过时了，于是在周一（27 日）中午迁移到了 Vite。

### 游戏

然后我又想到了高中时火过的 Wordle，以及高二、高三时玩过类似的，成语形式的，想着看能不能弄进去。

![](img/05-30_game-1.png)

一开始去 clone 了汉兜的源码，研究了一阵子如何嵌入项目，最终失败了。最后采用了 `iframe` 的方式。

![](img/05-30_game-2.png)

同时还进行了一些优化，例如把 xicons 的图标保存为本地 SVG，这样就可以移除掉很大的依赖了。

![](img/05-30_pack-3.png)

打包完后才发现端口转发对打包产物不生效，这代表就无法进行 API 请求。短时间内也没时间去探索解决方案了，因此就决定不进行打包了。

## 结语

代码部分的记录基本到此便结束了，至于答辩部分的记录，就得等我有时间再继续写了（大概七月前会写吧）。
